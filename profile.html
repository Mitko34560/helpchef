<!DOCTYPE html>
<html lang="bg">
<head>
<meta charset="UTF-8">
<title>Профил</title>
<link rel="stylesheet" href="style.css">
<script defer src="auth.js"></script>
</head>
<body>

<nav>
<h1>HelpChef</h1>
<button onclick="logout()">Logout</button>
</nav>

<div class="profile">
<h2 id="welcome"></h2>
</div>

<div id="adminPanel" class="admin-panel" style="display:none;">
<h3>Админ Панел</h3>
<div id="userList"></div>
</div>

<script>
const user = getCurrentUser();
if(!user) window.location="login.html";

document.getElementById("welcome").innerText="Добре дошъл, "+user.username;

if(user.role==="admin"){
document.getElementById("adminPanel").style.display="block";
loadUsers();
}

function loadUsers(){
let users=getUsers();
let container=document.getElementById("userList");
container.innerHTML="";
users.forEach(u=>{
if(u.username!==user.username){
container.innerHTML+=`
<div>
${u.username}
<button onclick="toggle('${u.username}')">
${u.blocked?"Разблокирай":"Блокирай"}
</button>
</div>
`;
}
});
}

function toggle(username){
let users=getUsers();
let u=users.find(x=>x.username===username);
u.blocked=!u.blocked;
saveUsers(users);
loadUsers();
}
</script>

</body>
</html>
