<!DOCTYPE html>
<html lang="bg">
<head>
<meta charset="UTF-8">
<title>–†–µ—Ü–µ–ø—Ç–∏</title>
<link rel="stylesheet" href="style.css">
<script src="auth.js" defer></script>
</head>
<body>

<nav>
<h1>HelpChef</h1>
<a href="index.html">–ù–∞—á–∞–ª–æ</a>
<a href="profile.html">–ü—Ä–æ—Ñ–∏–ª</a>
</nav>

<div class="profile">
<h2>–ö–∞—á–∏ —Ä–µ—Ü–µ–ø—Ç–∞</h2>

<input type="text" id="title" placeholder="–ò–º–µ">
<textarea id="content" placeholder="–û–ø–∏—Å–∞–Ω–∏–µ"></textarea>
<button class="btn" onclick="addRecipe()">–ö–∞—á–∏</button>
</div>

<hr>

<div class="section" id="recipesList"></div>

<script>
document.addEventListener("DOMContentLoaded",loadRecipes);

function getRecipes(){
return JSON.parse(localStorage.getItem("recipes")) || [];
}

function saveRecipes(r){
localStorage.setItem("recipes",JSON.stringify(r));
}

function addRecipe(){
const user=getCurrentUser();
if(!user){alert("–õ–æ–≥–Ω–∏ —Å–µ.");return;}

let recipes=getRecipes();

recipes.push({
title:document.getElementById("title").value,
content:document.getElementById("content").value,
author:user.username
});

saveRecipes(recipes);
loadRecipes();
}

function deleteRecipe(index){
let recipes=getRecipes();
recipes.splice(index,1);
saveRecipes(recipes);
loadRecipes();
}

function loadRecipes(){
let recipes=getRecipes();
let container=document.getElementById("recipesList");
let user=getCurrentUser();
container.innerHTML="";

recipes.forEach((r,i)=>{
container.innerHTML+=`
<div class="card">
<h3>${r.title}</h3>
<p>${r.content}</p>
<p>–ê–≤—Ç–æ—Ä: ${r.author}</p>
${user && user.role==="admin" ? 
`<button onclick="deleteRecipe(${i})">üóë –ò–∑—Ç—Ä–∏–π</button>` : ""}
</div>
`;
});
}
</script>

</body>
</html>
